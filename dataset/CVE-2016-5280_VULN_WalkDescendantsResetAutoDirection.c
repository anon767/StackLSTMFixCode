void
WalkDescendantsResetAutoDirection(Element* aElement)
{
  nsIContent* child = aElement->GetFirstChild();
  while (child) {
    if (child->HasDirAuto()) {
      child = child->GetNextNonChildNode(aElement);
      continue;
    }

    if (child->NodeType() == nsIDOMNode::TEXT_NODE &&
        child->HasTextNodeDirectionalityMap()) {
      nsTextNodeDirectionalityMap::ResetTextNodeDirection(static_cast<nsTextNode*>(child), nullptr);
      nsTextNodeDirectionalityMap::EnsureMapIsClearFor(child);
    }
    child = child->GetNextNode(aElement);
  }
}